SELECT
  CANAL_MDPREST,
  COUNT(*) AS c,
  COUNT(DISTINCT CODCLAVEPARTYCLI) AS clientes,
  SUM(MTODESEMBOLSADO) AS sum_mtodesembolsado
FROM TP_CUENTACREDITOPERSONAL
GROUP BY CANAL_MDPREST;

SELECT
  CANAL_MDPREST,
  COUNT(*) AS filas,
  COUNT(DISTINCT CODCLAVEPARTYCLI) AS clientes_distintos,
  SUM(MTODESEMBOLSADO) AS sum_mtodesembolsado,
  SUM(MTODESEMBOLSADOSOLES) AS sum_mtodesembolsado_soles
FROM TP_CUENTACREDITOPERSONAL
GROUP BY CANAL_MDPREST
ORDER BY filas DESC;
