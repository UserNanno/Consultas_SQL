WITH
TP_SOLICITUDCREDITOCONSUMO AS (
	SELECT
		A.CODCOLABORADORVENDEDOR,
		A.CODSOLICITUD,
		A.CODINTERNOCOMPUTACIONAL,
		A.FECSOLICITUD,
		A.HORSOLICITUD,
		A.DESTIPEVALUACIONSOLICITUD,
		A.CODPRODUCTO,
		A.DESTIPESTADOSOLICITUD,
		A.DESTIPESTADOEVALUACIONANALISTA,
		A.DESTIPESTADOEVALUACIONCDA,
		A.DESTIPETAPA,
		A.DESTIPESTADOJUSTIFICACIONSOLICITUD,
		A.DESTIPMOTIVORECHAZO,
		A.DESCOMENTARIO,
		UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) AS DESCAMPANIA,
		A.TIPEVALUACIONRIESGO,
		A.DESTIPEVALUACIONRIESGO,
		A.NBRMONEDA,
		A.MTOSOLICITADO,
		A.MTOAPROBADO,
		A.FECINICIOCALIF,
		A.HORINICIOCALIF,
		A.FECFINCALIF,
		A.HORFINCALIF,
		A.FECDESEMBOLSO,
		A.CODMATRICULACOLABORADORANALISTA,
		A.CODMATRICULACOLABORADORVENDEDOR,
		A.MTOCUOTAMENSUALAPROBADO,
		A.CTDPLAZOSOLICITADO,
		A.CTDPLAZOAPROBADO,
		A.PCTTASAEFECTIVAANUALSOLICITUD,
		A.PCTTASAEFECTIVAANUALAPROBADA,
		A.MTOINGRESOBRUTOSOLICITUD
	FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO A
	WHERE A.FECSOLICITUD >= '2025-10-01'
),
M_SOLICITUDCREDITOCONSUMO AS (
	SELECT
		A.CODSOLICITUD,
		A.CODINTERNOCOMPUTACIONAL,
		A.FECSOLICITUD,
		DAY(A.FECSOLICITUD) AS DIASOLICITUD,
		MONTH(A.FECSOLICITUD) AS MESSOLICITUD,
		YEAR(A.FECSOLICITUD) AS ANIOSOLICITUD,
		date_format(A.FECSOLICITUD, 'yyyyMM') AS CODMES,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECSOLICITUD, LPAD(A.HORSOLICITUD, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECREGISTRO,
		A.DESTIPEVALUACIONSOLICITUD AS TIPOEVALUACION,
		(CASE
			WHEN A.CODPRODUCTO = 'EFME' THEN 'LD'
			WHEN A.CODPRODUCTO = 'EFDP' THEN 'CONVENIO'
			WHEN A.CODPRODUCTO = 'EFCD' THEN 'CD'
			ELSE NULL
		END) AS DESPRODUCTO,
		A.DESTIPESTADOSOLICITUD AS ESTADOSOLICITUD,
		A.DESTIPESTADOEVALUACIONANALISTA AS RESULTADOANALISTA,
		(CASE
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION AUTOMATICA' AND A.DESTIPESTADOSOLICITUD = 'ACEPTADA' THEN 'ACEPTADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION AUTOMATICA' AND A.DESTIPESTADOEVALUACIONCDA = 'DECLINE' AND A.DESTIPESTADOSOLICITUD = 'DESACTIVADA' THEN 'ACEPTADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION AUTOMATICA' AND A.DESTIPESTADOSOLICITUD = 'DESACTIVADA' THEN 'DESACTIVADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION AUTOMATICA' AND A.DESTIPESTADOSOLICITUD = 'EN PROCESO' THEN 'EN PROCESO'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION AUTOMATICA' AND A.DESTIPESTADOSOLICITUD = 'SOLICITUD CANCELADA' THEN 'SOLICITUD CANCELADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'APROBADO POR ANALISTA DE CREDITOS' THEN 'ACEPTADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'APROBADO POR GERENTE - FIRMAS Y DESEMBOLSO' THEN 'ACEPTADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'ENVIADO A ANALISTA DE CREDITOS' THEN 'ENVIADO'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'ENVIADO A GERENTE - DOCUMENTACION ADICIONAL' THEN 'ENVIADO'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'ENVIADO A GERENTE - FIRMAS Y DESEMBOLSO' THEN 'ENVIADO'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'RECHAZADO POR GERENTE - DOCUMENTACION ADICIONAL' THEN 'DENEGADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'RECHAZADO POR GERENTE - FIRMAS Y DESEMBOLSO' THEN 'DENEGADA'
			WHEN A.DESTIPEVALUACIONSOLICITUD = 'EVALUACION EN CENTRALIZADO' AND A.DESTIPESTADOEVALUACIONANALISTA = 'INICIADO' THEN 'INICIADO'
			ELSE NULL
		END) AS ESTADO_F,
		A.DESTIPESTADOEVALUACIONCDA AS RESULTADOMOTORCDA,
		A.DESTIPETAPA,
		(CASE
			WHEN A.DESTIPESTADOJUSTIFICACIONSOLICITUD IS NULL THEN A.DESTIPMOTIVORECHAZO
			ELSE A.DESTIPESTADOJUSTIFICACIONSOLICITUD
		END) AS JUSTIFICACIONANALISTA,
		A.DESCOMENTARIO,
		(CASE
			WHEN A.DESCAMPANIA IS NOT NULL THEN A.DESCAMPANIA
			ELSE 'SIN CAMPANIA'
		END) AS DESCAMPANIA,
		(CASE
			WHEN INSTR(A.DESCAMPANIA, 'CONVENIO') > 0 THEN 'CONVENIO'
			WHEN INSTR(A.DESCAMPANIA, 'SHIELD') > 0 THEN 'SHIELD'
			WHEN A.TIPEVALUACIONRIESGO = 'APR' THEN '100% APROBADO'
			WHEN A.TIPEVALUACIONRIESGO = 'REA' THEN 'SIN CAMPANIA'
			WHEN A.TIPEVALUACIONRIESGO = 'PRE' THEN 'PREAPROBADO'
			WHEN A.TIPEVALUACIONRIESGO = 'INV' THEN 'INVITADO'
			WHEN A.TIPEVALUACIONRIESGO = 'OPT' THEN 'OPTIMUS'
			ELSE ''
		END) AS DESCAMPANIACORTA,
		A.NBRMONEDA,
		A.MTOSOLICITADO,
		A.MTOAPROBADO,
	    TO_TIMESTAMP(CONCAT_WS(' ', A.FECINICIOCALIF, LPAD(A.HORINICIOCALIF, 6, '0')), 'yyyy-MM-dd HHmmss') AS INICIOEVALUACION,
	    TO_TIMESTAMP(CONCAT_WS(' ', A.FECFINCALIF, LPAD(A.HORFINCALIF, 6, '0')), 'yyyy-MM-dd HHmmss') AS FINEVALUACION,
	    A.FECDESEMBOLSO,
	    (CASE
	    	WHEN A.FECDESEMBOLSO IS NOT NULL THEN A.MTOAPROBADO
	    	ELSE NULL
	    END) AS MTODESEMBOLSADO,
	    A.CODMATRICULACOLABORADORANALISTA,
	    A.CODMATRICULACOLABORADORVENDEDOR,
	    A.CODCOLABORADORVENDEDOR,
	    A.MTOCUOTAMENSUALAPROBADO,
		A.CTDPLAZOSOLICITADO,
		A.CTDPLAZOAPROBADO,
		A.PCTTASAEFECTIVAANUALSOLICITUD,
		A.PCTTASAEFECTIVAANUALAPROBADA,
		A.MTOINGRESOBRUTOSOLICITUD,
	    (CASE 
	    	WHEN A.NBRMONEDA LIKE '%DOLAR%' THEN A.MTOSOLICITADO * 3.81
	    	ELSE A.MTOSOLICITADO
	    END) AS MTOSOLICITADOSOLES,
	    (CASE 
	    	WHEN A.NBRMONEDA LIKE '%DOLAR%' THEN A.MTOAPROBADO * 3.81
	    	ELSE A.MTOAPROBADO
	    END) AS MTOAPROBADOSOLES
	FROM TP_SOLICITUDCREDITOCONSUMO A
),
M_SOLICITUDINDIVIDUO AS (
	SELECT
	    CODSOLICITUD,
	    DESTIPROLSOLICITUD,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN FLGCLIPAGOHABERESBCP
	    	ELSE NULL
	    END) AS CLIENTEBCPPDHTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN TIPRENTA
	    	ELSE NULL
	    END) AS TIPRENTATITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN TIPRENTA
	    	ELSE NULL
	    END) AS TIPRENTACONYUGE,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN NUMPUNTAJEPRECALIF
	    	ELSE NULL
	    END) AS SCOREEVALUACIONTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN TIPPARTYIDENTIFICACION
	    	ELSE NULL
	    END) AS TIPIDCTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN TIPPARTYIDENTIFICACION
	    	ELSE NULL
	    END) AS TIPIDCCONYUGE,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN MTOINGRESODIGITADO
	    	ELSE NULL
	    END) AS MTOINGRESOBRUTOTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN MTOINGRESODIGITADO
	    	ELSE NULL
	    END) AS MTOINGRESOBRUTOCONYUGE,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN MTOOTROINGRESODIGITADO
	    	ELSE NULL
	    END) AS MTOOTROINGRESOBRUTOTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN MTOOTROINGRESODIGITADO
	    	ELSE NULL
	    END) AS MTOOTROINGRESOBRUTOCONYUGE, 
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN MTOINGRESOCALCULADO
	    	ELSE NULL
	    END) AS MTOINGRESOPROMEDIOTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN MTOINGRESOCALCULADO
	    	ELSE NULL
	    END) AS MTOINGRESOPROMEDIOCONYUGE, 
	    MTOCEM,
	    MTOCEMASESORVENTA,
	    MTOCEMANALISTACREDITO,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN DESSUBSEGMENTO
	    	ELSE NULL
	    END) AS SEGMENTOTITULAR,
	   	(CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN MTODEUDATOTALBCP
	    	ELSE NULL
	    END) AS POSICIONCONSOLIDADA,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN CODSEGMENTORIESGOSCORE
	    	ELSE NULL
	    END) AS SEGMENTORIESGOTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN CODSEGMENTORIESGOSCORE
	    	ELSE NULL
	    END) AS SEGMENTORIESGOCONYUGE,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN DESTIPNIVELEDUCACIONAL
	    	ELSE NULL
	    END) AS GRADOINSTRUCCIONTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN DESTIPOCUPACION
	    	ELSE NULL
	    END) AS SITUACIONLABORALTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN DESTIPOCUPACION
	    	ELSE NULL
	    END) AS SITUACIONLABORALCONYUGE,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN NUMDEPENDIENTE
	    	ELSE NULL
	    END) AS NUMDEPENDIENTESTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN DESTIPESTCIVIL
	    	ELSE NULL
	    END) AS ESTADOCIVILTITULAR,
	    (CASE
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF <= 0 THEN 'SIN DATA'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 0 AND NUMPUNTAJEPRECALIF <= 300 THEN 'A. 1 - 300'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 300 AND NUMPUNTAJEPRECALIF <= 330 THEN 'B. >300 - 330'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 330 AND NUMPUNTAJEPRECALIF <= 360 THEN 'C. >330 - 360'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 360 AND NUMPUNTAJEPRECALIF <= 390 THEN 'D. >360 - 390'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 390 AND NUMPUNTAJEPRECALIF <= 420 THEN 'E. >390 - 420'
	    	WHEN DESTIPROLSOLICITUD = 'TITULAR' AND NUMPUNTAJEPRECALIF > 420 AND NUMPUNTAJEPRECALIF <= 450 THEN 'F. >420 - 450'
	    	ELSE 'G. >450'
	    END) AS RANGOSCORETITULAR
	FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDINDIVIDUO A
),
M_SOLICITUDPARTY AS (
  SELECT
    CODSOLICITUD,
    (CASE
    	WHEN DESTIPROLSOLICITUD = 'TITULAR' THEN DESTIPCLASIFRIESGOCLI
    	ELSE NULL
    END) AS CLASIFICACIONSBSTITULAR,
    (CASE
    	WHEN DESTIPROLSOLICITUD = 'CONYUGE' THEN DESTIPCLASIFRIESGOCLI
    	ELSE NULL
    END) AS CLASIFICACIONSBSCONYUGE
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDPARTY
),
USERAPP AS (
  SELECT
    CODUSUARIOAPP,
    DESPOSICIONCOLABORADOR
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_USUARIOAPLICATIVO
),
TP_BASE (
	SELECT
		A.CODSOLICITUD,
		A.CODINTERNOCOMPUTACIONAL,
		A.FECSOLICITUD,
		A.DIASOLICITUD,
		A.MESSOLICITUD,
		A.ANIOSOLICITUD,
		A.CODMES,
		A.FECREGISTRO,
		A.TIPOEVALUACION,
		A.DESPRODUCTO,
		A.ESTADOSOLICITUD,
		A.RESULTADOANALISTA,
		A.ESTADO_F,
		A.RESULTADOMOTORCDA,
		A.DESTIPETAPA,
		A.JUSTIFICACIONANALISTA,
		A.DESCOMENTARIO,
		A.DESCAMPANIA,
		A.DESCAMPANIACORTA,
		A.NBRMONEDA,
		A.MTOSOLICITADO,
		A.MTOAPROBADO,
		A.INICIOEVALUACION,
		A.FINEVALUACION,
		date_diff(SECOND, A.FECREGISTRO, A.FINEVALUACION)/3600 AS TIEMPOCLIENTEHRS,
		date_diff(SECOND, A.INICIOEVALUACION, A.FINEVALUACION)/3600 AS TIEMPOANALISTAHRS,
		date_diff(SECOND, A.FECREGISTRO, A.FINEVALUACION) AS TIEMPOCLIENTESEGUNDOS,
		date_diff(SECOND, A.INICIOEVALUACION, A.FINEVALUACION) AS TIEMPOANALISTASEGUNDOS,
		A.FECDESEMBOLSO,
		A.MTODESEMBOLSADO,
		A.CODMATRICULACOLABORADORANALISTA,
		A.CODMATRICULACOLABORADORVENDEDOR,
		A.MTOCUOTAMENSUALAPROBADO,
		A.CTDPLAZOSOLICITADO,
		A.CTDPLAZOAPROBADO,
		A.PCTTASAEFECTIVAANUALSOLICITUD,
		A.PCTTASAEFECTIVAANUALAPROBADA,
		A.MTOINGRESOBRUTOSOLICITUD,
		A.MTOSOLICITADOSOLES,
		(CASE
			WHEN A.MTOSOLICITADOSOLES <= 0 THEN 'SIN DATA'
			WHEN A.MTOSOLICITADOSOLES > 0 AND A.MTOSOLICITADOSOLES <= 23000 THEN 'A. 0 - 23k'
			WHEN A.MTOSOLICITADOSOLES > 23000 AND A.MTOSOLICITADOSOLES <= 46000 THEN 'B. >23k - 46k'
			WHEN A.MTOSOLICITADOSOLES > 46000 AND A.MTOSOLICITADOSOLES <= 69000 THEN 'C. >46k - 69k'
			WHEN A.MTOSOLICITADOSOLES > 69000 AND A.MTOSOLICITADOSOLES <= 92000 THEN 'D. >69k - 92k'
			WHEN A.MTOSOLICITADOSOLES > 92000 AND A.MTOSOLICITADOSOLES <= 115000 THEN 'E. >92k - 115k'
			WHEN A.MTOSOLICITADOSOLES > 115000 AND A.MTOSOLICITADOSOLES <= 138000 THEN 'F. >115k - 138k'
			WHEN A.MTOSOLICITADOSOLES > 138000 AND A.MTOSOLICITADOSOLES <= 160000 THEN 'G. >138k - 160k'
			ELSE 'H. >160k'
		END) AS RANGOMTOSOLICITADOSOLES,
		A.MTOAPROBADOSOLES,
		(CASE
			WHEN A.MTODESEMBOLSADO > 0 THEN '1'
			ELSE 0
		END) AS FLGMTODESEMBOLSADO,
		(CASE
			WHEN A.NBRMONEDA LIKE '%DOLAR%' AND A.ESTADO_F = 'ACEPTADA' THEN A.MTODESEMBOLSADO * 3.81
			ELSE A.MTODESEMBOLSADO
		END) AS MTODESEMBOLSADOSOLES,
		B.CLIENTEBCPPDHTITULAR,
		B.TIPRENTATITULAR,
		B.TIPRENTACONYUGE,
		B.SCOREEVALUACIONTITULAR,
		B.TIPIDCTITULAR,
		B.TIPIDCCONYUGE,
		B.MTOINGRESOBRUTOTITULAR,
		B.MTOINGRESOBRUTOCONYUGE,
		B.MTOOTROINGRESOBRUTOTITULAR,
		B.MTOOTROINGRESOBRUTOCONYUGE,
		B.MTOINGRESOPROMEDIOTITULAR,
		B.MTOINGRESOPROMEDIOCONYUGE,
		B.MTOCEM,
		B.MTOCEMASESORVENTA,
		B.MTOCEMANALISTACREDITO,
		B.SEGMENTOTITULAR,
		B.POSICIONCONSOLIDADA,
		B.SEGMENTORIESGOTITULAR,
		B.SEGMENTORIESGOCONYUGE,
		B.GRADOINSTRUCCIONTITULAR,
		B.SITUACIONLABORALTITULAR,
		B.SITUACIONLABORALCONYUGE,
		B.NUMDEPENDIENTESTITULAR,
		B.ESTADOCIVILTITULAR,
		B.RANGOSCORETITULAR,
		C.CLASIFICACIONSBSTITULAR,
		C.CLASIFICACIONSBSCONYUGE,
		D.DESPOSICIONCOLABORADOR
	FROM M_SOLICITUDCREDITOCONSUMO A
	LEFT JOIN M_SOLICITUDINDIVIDUO B ON (A.CODSOLICITUD = B.CODSOLICITUD)
	LEFT JOIN M_SOLICITUDPARTY C ON (A.CODSOLICITUD = C.CODSOLICITUD)
	LEFT JOIN USERAPP D ON (A.CODCOLABORADORVENDEDOR = D.CODUSUARIOAPP)
)
SELECT
	A.*,
	(CASE
		WHEN TIEMPOCLIENTEHRS IS NULL THEN NULL
		WHEN TIEMPOCLIENTEHRS >= 0 and TIEMPOCLIENTEHRS <= 24 THEN 'DENTRO 24HRS'
		WHEN TIEMPOCLIENTEHRS > 24 THEN 'MAYOR 24HRS'
		ELSE 'SIN DATA'
	END) AS ATENCION24HRSCLIENTE,
	(CASE
		WHEN TIEMPOCLIENTEHRS IS NULL THEN NULL
		WHEN TIEMPOCLIENTEHRS >= 0 AND TIEMPOCLIENTEHRS <= 12 THEN 'DENTRO 12HRS'
		WHEN TIEMPOCLIENTEHRS > 12 AND TIEMPOCLIENTEHRS <= 24 THEN 'DENTRO 24HRS'
		WHEN TIEMPOCLIENTEHRS > 24 THEN 'MAYOR 24HRS'
		ELSE 'SIN DATA'
	END) AS ATENCION12HRSCLIENTE,
	(CASE
		WHEN TIEMPOCLIENTEHRS IS NULL THEN NULL
		WHEN TIEMPOCLIENTEHRS > 0 AND TIEMPOCLIENTEHRS <= 3 THEN 'A. 0 - 3'
		WHEN TIEMPOCLIENTEHRS > 3 AND TIEMPOCLIENTEHRS <= 6 THEN 'B. >3 - 6'
		WHEN TIEMPOCLIENTEHRS > 6 AND TIEMPOCLIENTEHRS <= 12 THEN 'C. >6 - 12'
		WHEN TIEMPOCLIENTEHRS > 12 AND TIEMPOCLIENTEHRS <= 18 THEN 'D. >12 - 18'
		WHEN TIEMPOCLIENTEHRS > 18 AND TIEMPOCLIENTEHRS <= 24 THEN 'E. >18 - 24'
		WHEN TIEMPOCLIENTEHRS > 24 THEN 'F. >24'
		ELSE 'SIN DATA'
	END) AS RANGOATENCIONCLIENTE
FROM TP_BASE A;
