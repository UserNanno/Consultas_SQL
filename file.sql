WITH 
SOLICITUDCEF AS (
  SELECT CODSOLICITUD, CODINTERNOCOMPUTACIONAL, DESPRODUCTO 
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO
),
SOLICITUDINDIVIDUO_T AS (
  SELECT CODSOLICITUD, CODINTERNOCOMPUTACIONAL, TIPRENTA AS TIPRENTATITULAR
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDINDIVIDUO
  WHERE DESTIPROLSOLICITUD = 'TITULAR'
),
SOLICITUDINDIVIDUO_C AS (
  SELECT CODSOLICITUD, CODINTERNOCOMPUTACIONAL, TIPRENTA AS TIPRENTACONYUGE
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDINDIVIDUO
  WHERE DESTIPROLSOLICITUD = 'CONYUGE'
),
SOLICITUDPARTY_T AS (
  SELECT CODSOLICITUD, CODINTERNOCOMPUTACIONAL, DESTIPCLASIFRIESGOCLI AS CLASIFICACIONSBSTITULAR
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDPARTY
  WHERE DESTIPROLSOLICITUD = 'TITULAR'
),
SOLICITUDPARTY_C AS (
  SELECT CODSOLICITUD, CODINTERNOCOMPUTACIONAL, DESTIPCLASIFRIESGOCLI AS CLASIFICACIONSBSCONYUGE
  FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDPARTY
  WHERE DESTIPROLSOLICITUD = 'CONYUGE'
)
SELECT
  A.CODSOLICITUD,
  A.CODINTERNOCOMPUTACIONAL,
  B.TIPRENTATITULAR,
  C.TIPRENTACONYUGE,
  D.CLASIFICACIONSBSTITULAR,
  E.CLASIFICACIONSBSCONYUGE
FROM SOLICITUDCEF A
LEFT JOIN SOLICITUDINDIVIDUO_T B ON (A.CODSOLICITUD = B.CODSOLICITUD)
LEFT JOIN SOLICITUDINDIVIDUO_C C ON (A.CODSOLICITUD = C.CODSOLICITUD)
LEFT JOIN SOLICITUDPARTY_T D ON (A.CODSOLICITUD = D.CODSOLICITUD)
LEFT JOIN SOLICITUDPARTY_C E ON (A.CODSOLICITUD = E.CODSOLICITUD)
WHERE A.CODSOLICITUD = 'O0018105175'
ORDER BY 1, 2 DESC;
