CREATE OR REPLACE VIEW catalog_lhcl_prod_bcp.bcp_edv_rbmdbn.vw_t72496_centralizado_unificado AS
SELECT
    -- columnas comunes o alineadas del CEF
    codsolicitud,
    codinternocomputacional,
    fecregistro,
    tipoevaluacion,
    tipoproducto,
    subproducto,
    desproducto,
    estadosolicitud,
    resultadoanalista,
    estado_f,
    resultadomotorcda,
    motivocda,
    destipetapa,
    justificacionanalista,
    comentarioanalista,
    descampania,
    descampaniacorta,
    nbrmoneda,
    mtosolicitado,
    mtoaprobado,
    inicioevaluacion,
    finevaluacion,
    fecdesembolso,
    mtodesembolsado,
    codmatriculacolaboradoranalista,
    codmatriculacolaboradorvendedor,
    mtocuotamensualaprobado,
    ctdplazosolicitado,
    ctdplazoaprobado,
    pcttasaefectivaanualsolicitud,
    pcttasaefectivaanualaprobada,
    mtoingresobrutosolicitud,
    mtosolicitadosoles,
    mtoaprobadosoles,
    mtodesembolsadosoles,
    cliente_bcp_pdh_titular,
    tiprentatitular,
    tiprentaconyuge,
    scoreevaluaciontitular,
    tipidctitular,
    tipidcconyuge,
    mtoingresobrutotitular,
    mtoingresobrutoconyuge,
    mtootringresobrutotitular,
    mtootringresobrutoconyuge,
    mtoingresopromediotitular,
    mtoingresopromedioconyuge,
    mtocemtitular,
    mtocemasesorventatitular,
    mtocemanalistacreditotitular,
    segmentotitular,
    posicionconsolidadatitular,
    segmentoriesgotitular,
    segmentoriesgoconyuge,
    gradoinstrucciontitular,
    situacionlaboraltitular,
    situacionlaboralconyuge,
    numdependientestitular,
    estadociviltitular,
    rangoscoretitular,
    clasificacionsbstitular,
    clasificacionsbsconyuge,
    desposicioncolaborador,
    tiempoclientehrs,
    tiempoanalistahrs,
    tiempoclientesegundos,
    tiempoanalistasegundos,
    rangomtosolicitadosoles,
    flgmtodesembolsado,
    diassolicitud,
    messolicitud,
    aniosolicitud,
    codmes,
    'CEF' AS fuente
FROM catalog_lhcl_prod_bcp.bcp_edv_rbmdbn.t72496_centralizado_cef

UNION ALL

SELECT
    codsolicitud,
    codinternocomputacional,
    fecregistro,
    tipoevaluacion,
    tipoproducto,
    subproducto,
    desproducto,
    estadosolicitud,
    resultadoanalista,
    estado_f,
    resultadomotorcda,
    motivocda,
    destipetapa,
    justificacionanalista,
    comentarioanalista,
    descampania,
    descampaniacorta,
    nbrmoneda,
    mtosolicitado,
    mtoaprobado,
    inicioevaluacion,
    finevaluacion,
    fecdesembolso,
    mtodesembolsado,
    codmatriculacolaboradoranalista,
    codmatriculacolaboradorvendedor,
    mtocuotamensualaprobado,
    ctdplazosolicitado,
    ctdplazoaprobado,
    pcttasaefectivaanualsolicitud,
    pcttasaefectivaanualaprobada,
    mtoingresobrutosolicitud,
    mtosolicitadosoles,
    mtoaprobadosoles,
    mtodesembolsadosoles,
    cliente_bcp_pdh_titular,
    tiprentatitular,
    tiprentaconyuge,
    scoreevaluaciontitular,
    tipidctitular,
    tipidcconyuge,
    mtoingresobrutotitular,
    mtoingresobrutoconyuge,
    mtootringresobrutotitular,
    mtootringresobrutoconyuge,
    mtoingresopromediotitular,
    mtoingresopromedioconyuge,
    mtocemtitular,
    mtocemasesorventatitular,
    mtocemanalistacreditotitular,
    segmentotitular,
    posicionconsolidadatitular,
    segmentoriesgotitular,
    segmentoriesgoconyuge,
    gradoinstrucciontitular,
    situacionlaboraltitular,
    situacionlaboralconyuge,
    numdependientestitular,
    estadociviltitular,
    rangoscoretitular,
    clasificacionsbstitular,
    clasificacionsbsconyuge,
    desposicioncolaborador,
    tiempoclientehrs,
    tiempoanalistahrs,
    tiempoclientesegundos,
    tiempoanalistasegundos,
    rangomtosolicitadosoles,
    flgmtodesembolsado,
    diassolicitud,
    messolicitud,
    aniosolicitud,
    codmes,
    'TC' AS fuente
FROM catalog_lhcl_prod_bcp.bcp_edv_rbmdbn.t72496_centralizado_tc
;
