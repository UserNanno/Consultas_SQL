TP_BASE_UNION AS (
	SELECT 
		A.*,
		B.NBRUNIDADORGANIZATIVAVENDEDOR,
		B.NBRAREAUNIDADORGANIZATIVAVENDEDOR,
		B.NBRSERVUNIDADORGANIZATIVAVENDEDOR,
		B.CANAL,
		C.DESTIPRENTA,
		C.SEGMENTO,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORDESEMBOLSO) / 3600, 2) AS TIEMPOATENCIONSOLICITUD,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORINICIOEVALUACION) / 3600, 2) AS TIEMPODERIVACIONANALISTA,
		ROUND(date_diff(SECOND, A.FECHORINICIOEVALUACION, A.FECHORFINEVALUACION) / 3600, 2) AS TIEMPOATENCIONANALISTA,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORFINEVALUACION) / 3600, 2) AS TIEMPOATENCIONSOLICITUDANALISTA
		--ROUND(date_diff(SECOND, A.FECHORFINEVALUACION, A.FECHORDESEMBOLSO) / 3600, 2) AS TIEMPODESEMBOLSOPOSTATENCIONANALISTA
	FROM TP_UNION A
	LEFT JOIN TP_COLABORADORVENDEDOR B ON (A.FECSOLICITUD = B.FECDIA AND A.CODMATRICULACOLABORADORVENDEDOR = B.MATORGANICO)
	LEFT JOIN TP_SOLICITUDINDIVIDUO C ON (A.CODSOLICITUD = C.CODSOLICITUD)
),
