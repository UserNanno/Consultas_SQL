Hoal tengo un problema de coincidencias en mis solicitudes en dos tablas de databricks. 

Esta es la query que uso para crear una tabla 

CREATE OR REPLACE TABLE CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_UNIONWEEKLY
AS
WITH
TP_TIPOCAMBIO AS (
	SELECT 3.81 AS TC_USD_SOL
),
TP_BASESOLICITUDESSALESFORCE AS (
	SELECT
		A.CODMESEVALUACION AS CODMESEVALUACION,
    	A.CODSOLICITUD,
    	(CASE
			WHEN A.NBRDIVISA = 'USD' THEN A.MTOSOLICITADO * B.TC_USD_SOL
			ELSE A.MTOSOLICITADO
		END) AS MTOSOLICITADO,
     	(CASE
			WHEN A.NBRDIVISA = 'USD' THEN A.MTOAPROBADO * B.TC_USD_SOL
			ELSE A.MTOAPROBADO
		END) AS MTOAPROBADO,
    	A.MATANALISTA_FINAL AS MATRICULA,
    	A.ESTADOSOLICITUDANALISTA AS ESTADOSOLICITUD,
    	A.ESTADOSOLICITUDPASO,
    	A.TIPACCION AS DESTIPPRODUCTO,
    	A.NBRPRODUCTO AS DESPRODUCTO,
    	A.ETAPA AS DESTIPETAPA,
		A.MOTIVOMALADERIVACION,
		A.SUBMOTIVOMALADERIVACION,
		A.FECINICIOEVALUACION_ULT AS FECINICIOEVALUACION
	FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.TP_SOLICITUDES_CENTRALIZADO A
	CROSS JOIN TP_TIPOCAMBIO B
),
TP_COLABORADOR AS (
    SELECT
        FECDIA,
        date_format(FECDIA, 'yyyyMM') AS CODMES,
        CODMATRICULA,
        CODMATRICULASUP,
        NBRUNIDADORGANIZATIVA,
        NBRAREAUNIDADORGANIZATIVA,
        NBRSERVUNIDADORGANIZATIVA,
        (CASE
        	WHEN NBRAREAUNIDADORGANIZATIVA IN ('AREA COMERCIAL PROVINCIAS 1', 'AREA COMERCIAL PROVINCIAS 2', 'AREA COMERCIAL LIMA 2', 'AREA COMERCIAL LIMA 1') THEN 'DCA'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA CENTRO DE CONTACTO Y VENTAS' THEN 'TLMK'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA BANCA AFLUENTE' AND NBRSERVUNIDADORGANIZATIVA = 'GERENCIA DE BANCA ENALTA' THEN 'ENALTA'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA BANCA AFLUENTE' AND NBRSERVUNIDADORGANIZATIVA = 'GERENCIA DE BANCA EXCLUSIVA DIGITAL' THEN 'BEX'
			ELSE 'OTROS'
		END) AS CANAL,
		FECACTUALIZACIONREGISTRO
    FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.H_COLABORADOR
    WHERE DESTIPESTADOLABORAL = 'Activo'
),
TP_COLABORADORANALISTA AS (
    SELECT
        FECDIA,
        CODMES,
        MATORGANICO,
        MATSUPERIOR,
        NBRAREAUNIDADORGANIZATIVA
    FROM (
        SELECT
            FECDIA,
            CODMES,
            CODMATRICULA       AS MATORGANICO,
            CODMATRICULASUP    AS MATSUPERIOR,
            NBRAREAUNIDADORGANIZATIVA,
            ROW_NUMBER() OVER (
                PARTITION BY FECDIA, CODMATRICULA
                ORDER BY FECACTUALIZACIONREGISTRO DESC
            ) AS rn
        FROM TP_COLABORADOR
    ) x
    WHERE rn = 1
)
	SELECT
		A.CODMESEVALUACION AS CODMES,
	    A.CODSOLICITUD,
	    (CASE 
	    	WHEN A.ESTADOSOLICITUD = 'PENDIENTE' AND A.DESTIPETAPA = 'DESESTIMADA' THEN 'RECHAZADO'
	    	ELSE A.ESTADOSOLICITUD
	    END) AS ESTADOSOLICITUD,
	    A.ESTADOSOLICITUDPASO,
		A.MOTIVOMALADERIVACION,
		A.SUBMOTIVOMALADERIVACION,
	    A.MTOSOLICITADO,
		A.MTOAPROBADO,
	    A.MATRICULA AS MATANALISTA,
	    A.DESTIPPRODUCTO AS PRODUCTO,
	    A.DESPRODUCTO,
	    A.DESTIPETAPA,
	    B.NBRAREAUNIDADORGANIZATIVA,
	    B.MATSUPERIOR
	FROM TP_BASESOLICITUDESSALESFORCE A
	LEFT JOIN TP_COLABORADORANALISTA B ON (B.FECDIA = A.FECINICIOEVALUACION AND B.MATORGANICO = A.MATRICULA)


Cuando ejecuto la siguiente query me salen ciertos resultados:
SELECT
	A.CODMES,
	SUM(CASE WHEN B.CODSOLICITUD IS NOT NULL THEN 1 ELSE 0 END) AS COINCIDENCIAS,
	SUM(CASE WHEN B.CODSOLICITUD IS NULL THEN 1 ELSE 0 END) AS NO_COINCIDENCIAS
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_UNIONWEEKLY A
LEFT JOIN CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO B ON (A.CODSOLICITUD = B.CODSOLICITUD)
WHERE A.CODMES BETWEEN 202510 AND 202512
GROUP BY ALL
ORDER BY 1 DESC;

CODMES | COINCIDENCIAS | NO_COINCIDENCIAS
202512 | 4578 | 8228
202511 | 5143 | 9177
202510 | 5518 | 11247

Pero cuando ya avanzo en esta CTE a hacer el cruce con las tablas con la siguiente query:

CREATE OR REPLACE TABLE CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_UNIONWEEKLY
AS
WITH
TP_TIPOCAMBIO AS (
	SELECT 3.81 AS TC_USD_SOL
),
TP_BASESOLICITUDESSALESFORCE AS (
	SELECT
		A.CODMESEVALUACION AS CODMESEVALUACION,
    	A.CODSOLICITUD,
    	(CASE
			WHEN A.NBRDIVISA = 'USD' THEN A.MTOSOLICITADO * B.TC_USD_SOL
			ELSE A.MTOSOLICITADO
		END) AS MTOSOLICITADO,
     	(CASE
			WHEN A.NBRDIVISA = 'USD' THEN A.MTOAPROBADO * B.TC_USD_SOL
			ELSE A.MTOAPROBADO
		END) AS MTOAPROBADO,
    	A.MATANALISTA_FINAL AS MATRICULA,
    	A.ESTADOSOLICITUDANALISTA AS ESTADOSOLICITUD,
    	A.ESTADOSOLICITUDPASO,
    	A.TIPACCION AS DESTIPPRODUCTO,
    	A.NBRPRODUCTO AS DESPRODUCTO,
    	A.ETAPA AS DESTIPETAPA,
		A.MOTIVOMALADERIVACION,
		A.SUBMOTIVOMALADERIVACION,
		A.FECINICIOEVALUACION_ULT AS FECINICIOEVALUACION
	FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.TP_SOLICITUDES_CENTRALIZADO A
	CROSS JOIN TP_TIPOCAMBIO B
),
TP_COLABORADOR AS (
    SELECT
        FECDIA,
        date_format(FECDIA, 'yyyyMM') AS CODMES,
        CODMATRICULA,
        CODMATRICULASUP,
        NBRUNIDADORGANIZATIVA,
        NBRAREAUNIDADORGANIZATIVA,
        NBRSERVUNIDADORGANIZATIVA,
        (CASE
        	WHEN NBRAREAUNIDADORGANIZATIVA IN ('AREA COMERCIAL PROVINCIAS 1', 'AREA COMERCIAL PROVINCIAS 2', 'AREA COMERCIAL LIMA 2', 'AREA COMERCIAL LIMA 1') THEN 'DCA'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA CENTRO DE CONTACTO Y VENTAS' THEN 'TLMK'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA BANCA AFLUENTE' AND NBRSERVUNIDADORGANIZATIVA = 'GERENCIA DE BANCA ENALTA' THEN 'ENALTA'
			WHEN NBRAREAUNIDADORGANIZATIVA = 'GCIA DE AREA BANCA AFLUENTE' AND NBRSERVUNIDADORGANIZATIVA = 'GERENCIA DE BANCA EXCLUSIVA DIGITAL' THEN 'BEX'
			ELSE 'OTROS'
		END) AS CANAL,
		FECACTUALIZACIONREGISTRO
    FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.H_COLABORADOR
    WHERE DESTIPESTADOLABORAL = 'Activo'
),
TP_COLABORADORANALISTA AS (
    SELECT
        FECDIA,
        CODMES,
        MATORGANICO,
        MATSUPERIOR,
        NBRAREAUNIDADORGANIZATIVA
    FROM (
        SELECT
            FECDIA,
            CODMES,
            CODMATRICULA       AS MATORGANICO,
            CODMATRICULASUP    AS MATSUPERIOR,
            NBRAREAUNIDADORGANIZATIVA,
            ROW_NUMBER() OVER (
                PARTITION BY FECDIA, CODMATRICULA
                ORDER BY FECACTUALIZACIONREGISTRO DESC
            ) AS rn
        FROM TP_COLABORADOR
    ) x
    WHERE rn = 1
),
TP_BASE_SOLICITUDES AS (
	SELECT
		A.CODMESEVALUACION AS CODMES,
	    A.CODSOLICITUD,
	    (CASE 
	    	WHEN A.ESTADOSOLICITUD = 'PENDIENTE' AND A.DESTIPETAPA = 'DESESTIMADA' THEN 'RECHAZADO'
	    	ELSE A.ESTADOSOLICITUD
	    END) AS ESTADOSOLICITUD,
	    A.ESTADOSOLICITUDPASO,
		A.MOTIVOMALADERIVACION,
		A.SUBMOTIVOMALADERIVACION,
	    A.MTOSOLICITADO,
		A.MTOAPROBADO,
	    A.MATRICULA AS MATANALISTA,
	    A.DESTIPPRODUCTO AS PRODUCTO,
	    A.DESPRODUCTO,
	    A.DESTIPETAPA,
	    B.NBRAREAUNIDADORGANIZATIVA,
	    B.MATSUPERIOR
	FROM TP_BASESOLICITUDESSALESFORCE A
	LEFT JOIN TP_COLABORADORANALISTA B ON (B.FECDIA = A.FECINICIOEVALUACION AND B.MATORGANICO = A.MATRICULA)
),
TP_COLABORADORVENDEDOR AS (
    SELECT
        FECDIA,
        CODMES,
        MATORGANICO,
        MATSUPERIOR,
        NBRUNIDADORGANIZATIVAVENDEDOR,
        NBRAREAUNIDADORGANIZATIVAVENDEDOR,
        NBRSERVUNIDADORGANIZATIVAVENDEDOR,
        CANAL
    FROM (
        SELECT
            FECDIA,
            CODMES,
            CODMATRICULA       AS MATORGANICO,
            CODMATRICULASUP    AS MATSUPERIOR,
            NBRUNIDADORGANIZATIVA     AS NBRUNIDADORGANIZATIVAVENDEDOR,
            NBRAREAUNIDADORGANIZATIVA AS NBRAREAUNIDADORGANIZATIVAVENDEDOR,
            NBRSERVUNIDADORGANIZATIVA AS NBRSERVUNIDADORGANIZATIVAVENDEDOR,
            CANAL,
            ROW_NUMBER() OVER (
                PARTITION BY FECDIA, CODMATRICULA
                ORDER BY FECACTUALIZACIONREGISTRO DESC
            ) AS rn
        FROM TP_COLABORADOR
    ) x
    WHERE rn = 1
),
TP_SOLICITUDINDIVIDUO AS (
	SELECT
    	CODSOLICITUD,
    	(CASE
			WHEN CODSUBSEGMENTO IN ('X1N', 'X1E') THEN 'BEX'
			WHEN CODSUBSEGMENTO IN ('Q1N', 'Q1E') THEN 'PYME'
			WHEN CODSUBSEGMENTO IN ('P1N', 'P1E') THEN 'PRIVADA'
			WHEN CODSUBSEGMENTO IN ('NBN', 'NBE') THEN 'NO BANCO'
			WHEN CODSUBSEGMENTO IN ('M1N', 'M1E') THEN 'CONSUMO'
			WHEN CODSUBSEGMENTO IN ('LEN', 'LEE') THEN 'ENALTA'
			WHEN CODSUBSEGMENTO IN ('C1N', 'C1E') THEN 'NEGOCIOS'
			WHEN CODSUBSEGMENTO = 'G1N' THEN 'GREMIO 94'
			ELSE 'OTROS'
		END) AS SEGMENTO,
    	(CASE
			WHEN TIPRENTA = 5 THEN '5TA'
			WHEN TIPRENTA = 4 THEN '4TA'
			WHEN TIPRENTA = 3 THEN '3RA'
			WHEN TIPRENTA = 2 THEN '2DA'
			WHEN TIPRENTA = 1 THEN '1RA'
			ELSE 'OTROS'
		END) AS DESTIPRENTA
	FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDINDIVIDUO
	WHERE DESTIPROLSOLICITUD = 'TITULAR'
),
TP_SOLICITUDCREDITOCONSUMO AS (
	SELECT
		A.CODSOLICITUD,
		A.DESTIPETAPA,
		A.DESTIPESTADOSOLICITUD,
		A.DESTIPSOLICITUD AS TIPOPERACION,
		A.DESTIPSOLICITUD AS DESTIPOPERACION,
		(CASE
			WHEN A.CODPRODUCTO = 'EFME' THEN 'LIBRE DISPONIBILIDAD'
			WHEN A.CODPRODUCTO = 'EFCD' THEN 'COMPRA DEUDA'
			WHEN A.CODPRODUCTO = 'EFDP' THEN 'CONVENIO'
			ELSE 'OTROS'
		END) AS PRODUCTO,
		CAST(NULL AS STRING) AS DESPRODUCTO,
		UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) AS DESCAMPANIA,
		A.DESTIPEVALUACIONRIESGO,
		A.CODMATRICULACOLABORADORANALISTA,
		A.CODMATRICULACOLABORADORVENDEDOR,
		A.NBRAGE,
		date_format(A.FECSOLICITUD, 'yyyyMM') AS CODMES,
		A.FECSOLICITUD,
		substring(HORINICIOCALIF, 1, 2) AS HORINICIOATENCION,
		dayofmonth(FECINICIOCALIF) AS NUMDIAINICIOATENCION,
		(CASE
			WHEN dayofmonth(FECINICIOCALIF) BETWEEN 1 AND 7 THEN 'S1'
			WHEN dayofmonth(FECINICIOCALIF) BETWEEN 8 AND 14 THEN 'S2'
			WHEN dayofmonth(FECINICIOCALIF) BETWEEN 15 AND 21 THEN 'S3'
			ELSE 'S4'
		END) AS NUMSEMANAMESINICIOATENCION,
		(CASE pmod(dayofweek(FECINICIOCALIF) + 5, 7) + 1
			WHEN 1 THEN 'LUN'
			WHEN 2 THEN 'MAR'
			WHEN 3 THEN 'MIE'
			WHEN 4 THEN 'JUE'
			WHEN 5 THEN 'VIE'
			WHEN 6 THEN 'SAB'
			WHEN 7 THEN 'DOM'
		END) AS NBRDIASEMANAINICIOATENCION,
		pmod(dayofweek(FECINICIOCALIF) + 5, 7) + 1 AS NBRDIASEMANAINICIOATENCION_ORD,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECSOLICITUD, LPAD(A.HORSOLICITUD, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORSOLICITUD,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECINICIOCALIF, LPAD(A.HORINICIOCALIF, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORINICIOEVALUACION,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECFINCALIF, LPAD(A.HORFINCALIF, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORFINEVALUACION,
		(CASE
			WHEN A.NBRMONEDA LIKE '%SOL%' THEN 'SOLES'
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN 'DOLARES'
			ELSE NULL
		END) AS NBRMONEDA,
		(CASE
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN A.MTOSOLICITADO * B.TC_USD_SOL
			ELSE A.MTOSOLICITADO
		END) AS MTOSOLICITADO,
		(CASE
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN A.MTOAPROBADO * B.TC_USD_SOL
			ELSE A.MTOAPROBADO
		END) AS MTOAPROBADO,
		A.FECDESEMBOLSO,
		TO_TIMESTAMP(CONCAT(A.FECDESEMBOLSO, ' 23:59:59'), 'yyyy-MM-dd HH:mm:ss') AS FECHORDESEMBOLSO
	FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO A
	CROSS JOIN TP_TIPOCAMBIO B
),
TP_SOLICITUDTARJETACREDITO AS (
	SELECT
		A.CODSOLICITUD,
		A.DESTIPETAPA,
		A.DESTIPESTADOSOLICITUD,
		A.DESTIPSOLICITUD AS TIPOPERACION,
		(CASE
			WHEN A.DESTIPFLUJOVENTATARJETACREDITO IN ('ADICIONAL', 'AMPLIACION', 'EP', 'UPGRADE', 'BT') THEN 'TARJETA CREDITO STOCK'
			WHEN A.DESTIPFLUJOVENTATARJETACREDITO IN ('TC', 'SEGUNDA TC') THEN 'TARJETA CREDITO NUEVA'
			ELSE NULL
		END) AS DESTIPOPERACION,
		A.DESTIPFLUJOVENTATARJETACREDITO AS PRODUCTO,
		UPPER(A.DESPRODUCTO) AS DESPRODUCTO,
		UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) AS DESCAMPANIA,
		(CASE
			WHEN UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) LIKE '%100%%' THEN '100% APROBADO'
			WHEN UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) LIKE '%PREA%' THEN 'PREAPROBADO' -- [PREAPROBADO, PREAPROB, PREAPRO, PREAPR]
			WHEN UPPER(TRANSLATE(A.DESCAMPANIA, 'ÁÉÍÓÚÜÑáéíóúüñ', 'AEIOUUNAEIOUUN')) LIKE '%REACTIVO%' THEN 'REACTIVO'
			ELSE 'OTROS'
		END) AS DESTIPEVALUACIONRIESGO,
		A.CODMATRICULACOLABORADORAPROBADOR AS CODMATRICULACOLABORADORANALISTA,
		A.CODMATRICULACOLABORADORVENDEDOR,
		A.NBRAGE,
		date_format(A.FECSOLICITUD, 'yyyyMM') AS CODMES,
		A.FECSOLICITUD,
		substring(HORINICIOEVALUACION, 1, 2) AS HORINICIOATENCION,
		dayofmonth(FECINICIOEVALUACION) AS NUMDIAINICIOATENCION,
		(CASE
			WHEN dayofmonth(FECINICIOEVALUACION) BETWEEN 1 AND 7 THEN 'S1'
			WHEN dayofmonth(FECINICIOEVALUACION) BETWEEN 8 AND 14 THEN 'S2'
			WHEN dayofmonth(FECINICIOEVALUACION) BETWEEN 15 AND 21 THEN 'S3'
			ELSE 'S4'
		END) AS NUMSEMANAMESINICIOATENCION,
		(CASE pmod(dayofweek(FECINICIOEVALUACION) + 5, 7) + 1
			WHEN 1 THEN 'LUN'
			WHEN 2 THEN 'MAR'
			WHEN 3 THEN 'MIE'
			WHEN 4 THEN 'JUE'
			WHEN 5 THEN 'VIE'
			WHEN 6 THEN 'SAB'
			WHEN 7 THEN 'DOM'
		END) AS NBRDIASEMANAINICIOATENCION,
		pmod(dayofweek(FECINICIOEVALUACION) + 5, 7) + 1 AS NBRDIASEMANAINICIOATENCION_ORD,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECSOLICITUD, LPAD(A.HORSOLICITUD, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORSOLICITUD,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECINICIOEVALUACION, LPAD(A.HORINICIOEVALUACION, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORINICIOEVALUACION,
		TO_TIMESTAMP(CONCAT_WS(' ', A.FECFINEVALUACION, LPAD(A.HORFINEVALUACION, 6, '0')), 'yyyy-MM-dd HHmmss') AS FECHORFINEVALUACION,
		(CASE
			WHEN A.NBRMONEDA LIKE '%SOL%' THEN 'SOLES'
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN 'DOLARES'
			ELSE NULL
		END) AS NBRMONEDA,
		(CASE
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN A.MTOSOLICITADO * B.TC_USD_SOL
			ELSE A.MTOSOLICITADO
		END) AS MTOSOLICITADO,
		(CASE
			WHEN A.NBRMONEDA LIKE '%DOL%' THEN A.MTOAPROBADO * B.TC_USD_SOL
			ELSE A.MTOAPROBADO
		END) AS MTOAPROBADO,
		A.FECEMISIONTARJETACREDITO AS FECDESEMBOLSO,
		TO_TIMESTAMP(CONCAT(A.FECEMISIONTARJETACREDITO, ' 23:59:59'), 'yyyy-MM-dd HH:mm:ss') AS FECHORDESEMBOLSO
	FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDTARJETACREDITO A
	CROSS JOIN TP_TIPOCAMBIO B
	WHERE A.CODTIPREGAPP IN ('0126O000001xsIYQAY','0126O000001h0WaQAI','0126O000001h0WbQAI')
),
TP_UNION AS (
	SELECT * FROM TP_SOLICITUDCREDITOCONSUMO
	UNION ALL
	SELECT * FROM TP_SOLICITUDTARJETACREDITO
),
TP_BASE_UNION AS (
	SELECT 
		A.*,
		B.NBRUNIDADORGANIZATIVAVENDEDOR,
		B.NBRAREAUNIDADORGANIZATIVAVENDEDOR,
		B.NBRSERVUNIDADORGANIZATIVAVENDEDOR,
		B.CANAL,
		C.DESTIPRENTA,
		C.SEGMENTO,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORDESEMBOLSO) / 3600, 2) AS TIEMPOATENCIONSOLICITUD,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORINICIOEVALUACION) / 3600, 2) AS TIEMPODERIVACIONANALISTA,
		ROUND(date_diff(SECOND, A.FECHORINICIOEVALUACION, A.FECHORFINEVALUACION) / 3600, 2) AS TIEMPOATENCIONANALISTA,
		ROUND(date_diff(SECOND, A.FECHORSOLICITUD, A.FECHORFINEVALUACION) / 3600, 2) AS TIEMPOATENCIONSOLICITUDANALISTA
		--ROUND(date_diff(SECOND, A.FECHORFINEVALUACION, A.FECHORDESEMBOLSO) / 3600, 2) AS TIEMPODESEMBOLSOPOSTATENCIONANALISTA
	FROM TP_UNION A
	LEFT JOIN TP_COLABORADORVENDEDOR B ON (A.FECSOLICITUD = B.FECDIA AND A.CODMATRICULACOLABORADORVENDEDOR = B.MATORGANICO)
	LEFT JOIN TP_SOLICITUDINDIVIDUO C ON (A.CODSOLICITUD = C.CODSOLICITUD)
),
CALENDARIO AS (
    SELECT explode(
        sequence(to_date('2024-01-01'), to_date('2025-12-31'), interval 1 day)
    ) AS FECHA
),
DIMCALENDARIO AS (
    SELECT
        A.FECHA,
        (CASE
            WHEN dayofweek(A.FECHA) = 1 THEN 0       -- domingo (1)
            WHEN B.FECHA IS NOT NULL THEN 0              -- feriado
            ELSE 1
        END) AS FLGDIAUTIL
    FROM CALENDARIO A
    LEFT JOIN CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_DE_DIASNOHABILES B ON A.FECHA = B.FECHA
)
	SELECT
		A.CODMES,
		A.CODSOLICITUD,
		B.MATANALISTA,
		B.NBRAREAUNIDADORGANIZATIVA AS NBRAREAUNIDADORGANIZATIVAANALISTA,
		B.MATSUPERIOR,
		A.NBRAREAUNIDADORGANIZATIVAVENDEDOR,
		A.NBRAGE,
		A.CANAL,
		A.TIPOPERACION,
		A.DESTIPOPERACION,
		COALESCE(A.PRODUCTO, B.PRODUCTO) AS PRODUCTO,
		(CASE
			WHEN A.DESPRODUCTO IS NULL AND A.TIPOPERACION = 'CREDITO CONSUMO' THEN B.DESPRODUCTO
			ELSE COALESCE(B.DESPRODUCTO, A.DESPRODUCTO)
		END) AS DESPRODUCTO,
		A.DESCAMPANIA,
		A.DESTIPETAPA,
		A.DESTIPEVALUACIONRIESGO,
		A.FECSOLICITUD,
		A.HORINICIOATENCION,
		A.NUMDIAINICIOATENCION,
		A.NUMSEMANAMESINICIOATENCION,
		A.NBRDIASEMANAINICIOATENCION,
		A.NBRDIASEMANAINICIOATENCION_ORD,
		(CASE
			WHEN C.FLGDIAUTIL = 1 THEN 'SI'
			ELSE 'NO'
		END) AS FLGDIAUTIL,
		A.FECHORSOLICITUD,
		A.FECHORINICIOEVALUACION,
		A.FECHORFINEVALUACION,
		A.FECDESEMBOLSO,
		A.FECHORDESEMBOLSO,
		A.TIEMPOATENCIONSOLICITUD,
		A.TIEMPODERIVACIONANALISTA,
		A.TIEMPOATENCIONANALISTA,
		A.TIEMPOATENCIONSOLICITUDANALISTA,
		--A.TIEMPODESEMBOLSOPOSTATENCIONANALISTA,
		A.DESTIPRENTA,
		A.SEGMENTO,
		COALESCE(B.MTOSOLICITADO, A.MTOSOLICITADO) AS MTOSOLICITADO,
		COALESCE(B.MTOAPROBADO, A.MTOAPROBADO) AS MTOAPROBADO,
		A.DESTIPESTADOSOLICITUD,
		B.ESTADOSOLICITUD,
		B.ESTADOSOLICITUDPASO,
		CASE
		   -----------------------------------------------------------------
		   -- 1) CENTRALIZADO
		   -----------------------------------------------------------------
		   WHEN B.MATANALISTA IS NOT NULL
		        AND B.NBRAREAUNIDADORGANIZATIVA = 'TRIBU RIESGOS BDN Y CREDITOS MINORISTAS'
		   THEN 'CENTRALIZADO'
		   -----------------------------------------------------------------
		   -- 2) PUNTO DE CONTACTO - CREDITO CONSUMO
		   -----------------------------------------------------------------
		   WHEN A.TIPOPERACION = 'CREDITO CONSUMO'
		        AND A.DESTIPESTADOSOLICITUD IN ('ACEPTADA', 'DESACTIVADA', 'DENEGADA')
		        AND A.NBRAREAUNIDADORGANIZATIVAVENDEDOR IN (
		        	'AREA COMERCIAL PROVINCIAS 1', 'AREA COMERCIAL PROVINCIAS 2', 
		        	'AREA COMERCIAL LIMA 2', 'AREA COMERCIAL LIMA 1', 
		        	'GCIA DE AREA BANCA AFLUENTE', 'GCIA DE AREA CENTRO DE CONTACTO Y VENTAS'
		        )
		        AND A.CODMATRICULACOLABORADORANALISTA IS NULL
		   THEN 'PUNTO DE CONTACTO'
		   -----------------------------------------------------------------
		   -- 3) PUNTO DE CONTACTO - TARJETA DE CREDITO
		   -----------------------------------------------------------------
		   WHEN A.TIPOPERACION = 'TARJETA DE CREDITO'
		        AND A.DESTIPESTADOSOLICITUD IN ('ACEPTADA', 'DENEGADA')
		        AND A.DESTIPETAPA = 'CERRADA'
		        AND A.NBRAREAUNIDADORGANIZATIVAVENDEDOR IN (
		        	'AREA COMERCIAL PROVINCIAS 1', 'AREA COMERCIAL PROVINCIAS 2', 
		        	'AREA COMERCIAL LIMA 2', 'AREA COMERCIAL LIMA 1', 
		        	'GCIA DE AREA BANCA AFLUENTE', 'GCIA DE AREA CENTRO DE CONTACTO Y VENTAS'
		        )
		   THEN 'PUNTO DE CONTACTO'
		   -----------------------------------------------------------------
		   -- 4) Resto
		   -----------------------------------------------------------------
		   ELSE 'SIN INFORMACION'
		END AS CENTROATENCION,
		B.MOTIVOMALADERIVACION,
		B.SUBMOTIVOMALADERIVACION
	FROM TP_BASE_UNION A
	LEFT JOIN TP_BASE_SOLICITUDES B ON (A.CODSOLICITUD = B.CODSOLICITUD)
	LEFT JOIN DIMCALENDARIO C ON (A.FECSOLICITUD = C.FECHA)

Y vuelvo a ejecutar la misma query para verificar las cantidades me sale diferente:

SELECT
	A.CODMES,
	SUM(CASE WHEN B.CODSOLICITUD IS NOT NULL THEN 1 ELSE 0 END) AS COINCIDENCIAS,
	SUM(CASE WHEN B.CODSOLICITUD IS NULL THEN 1 ELSE 0 END) AS NO_COINCIDENCIAS
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_UNIONWEEKLY A
LEFT JOIN CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO B ON (A.CODSOLICITUD = B.CODSOLICITUD)
WHERE A.CODMES BETWEEN 202510 AND 202512 AND A.CENTROATENCION = 'CENTRALIZADO'
GROUP BY ALL
ORDER BY 1 DESC;
    
CODMES | COINCIDENCIAS | NO_COINCIDENCIAS
202512 | 4501 | 7962
202511 | 4915 | 8710
202510 | 5484 | 11198

Considera que cuando hago Me sale que todos los MATANALISTA ninguno es nulo
SELECT
	A.CODMES,
	SUM(CASE WHEN A.MATANALISTA IS NOT NULL THEN 1 ELSE 0 END) AS MATANALISTACOINCIDENCIAS,
	SUM(CASE WHEN A.MATANALISTA IS NULL THEN 1 ELSE 0 END) AS MATANALISTA_NOCOINCIDENCIA
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_UNIONWEEKLY A
WHERE A.CODMES BETWEEN 202510 AND 202512
GROUP BY ALL
ORDER BY 1 DESC;

En teoria todo lo que coincida con mi base inicial con la tabla de m_solicitudcreditoconsumo deberia ser centralizado
Peor no sé por qué tengo esa caida en todos los meses del año solo filtramos estos meses para no hacer tan grande el analisis
