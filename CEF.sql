SELECT CODSOLICITUD, FECSOLICITUD, HORSOLICITUD, FECINICIOCALIF, HORINICIOCALIF, FECFINCALIF, HORFINCALIF, substring(HORINICIOCALIF, 1, 2) AS HORINICIOATENCION, substring(HORFINCALIF, 1, 2) AS HORFINATENCION, dayofmonth(FECINICIOCALIF) AS NUMDIAINICIOATENCION, dayofmonth(FECFINCALIF) AS NUMDIAFINATENCION,
    (CASE
        WHEN dayofmonth(FECINICIOCALIF) BETWEEN 1 AND 7 THEN 'S1'
        WHEN dayofmonth(FECINICIOCALIF) BETWEEN 8 AND 14 THEN 'S2'
        WHEN dayofmonth(FECINICIOCALIF) BETWEEN 15 AND 21 THEN 'S3'
        ELSE 'S4'
    END) AS NUMSEMANAMES,
    cast(date_format(FECSOLICITUD, 'u') as int) AS NBRDIASEMANA
FROM CATALOG_LHCL_PROD_BCP.BCP_UDV_INT_VU.M_SOLICITUDCREDITOCONSUMO WHERE CODSOLICITUD IN ('O0018785911', 'O0018783674', 'O0018783467', 'O0018791255', 'O0019134860');


[INCONSISTENT_BEHAVIOR_CROSS_VERSION.DATETIME_PATTERN_RECOGNITION] You may get a different result due to the upgrading to Spark >= 3.0:

