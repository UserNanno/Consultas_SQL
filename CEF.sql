ES NORMAL QUE TENGA DUPLICADOS CUANDO NO DEBERIA TENERLO, ERRORES HUMANOS CUANDO LO HACIAN EN EXCEL PERO YA NO SE PUEDE MOVER ESTOS RESULTADOS

TE ADJUNTO LO QUE ME SALIO PARA EL QUERY ANTIGUO

SELECT COUNT(*) AS filas
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_MIGRACION_PLANCHON
WHERE CODMES BETWEEN 202501 AND 202512;

-- 834,698

SELECT COUNT(DISTINCT CODSOLICITUD) AS solicitudes
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_MIGRACION_PLANCHON
WHERE CODMES BETWEEN 202501 AND 202512;

-- 831,537

SELECT
  CODMES,
  DESTIPOPERACION,
  SUM(CASE WHEN FECDESEMBOLSO IS NOT NULL THEN 1 ELSE 0 END) AS cnt_con_fecha,
  SUM(CASE WHEN FLGDESEMBOLSADO = 1 THEN 1 ELSE 0 END) AS cnt_flg_desemb,
  SUM(MTODESEMBOLSADO) AS sum_mto_desemb
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_MIGRACION_PLANCHON
WHERE CODMES BETWEEN 202501 AND 202512
  AND DESTIPOPERACION NOT IN ('TARJETA CREDITO NUEVA','TARJETA CREDITO STOCK')
GROUP BY CODMES, DESTIPOPERACION
ORDER BY CODMES, DESTIPOPERACION;

-- 202501 | CREDITO CONSUMO | 14676 | 14676 | 598345637.46
-- 202502 | CREDITO CONSUMO | 13205 | 13205 | 529434090.66
-- 202503 | CREDITO CONSUMO | 13465 | 13465 | 529434090.66
-- 202504 | CREDITO CONSUMO | 11797 | 11797 | 471669226.21
-- 202505 | CREDITO CONSUMO | 12159 | 12159 | 512785677.37
-- 202506 | CREDITO CONSUMO | 14236 | 14236 | 608448473.5
-- 202507 | CREDITO CONSUMO | 12866 | 12866 | 537823224.09
-- 202508 | CREDITO CONSUMO | 11188 | 11188 | 459321073.27
-- 202509 | CREDITO CONSUMO | 11281 | 11281 | 406031231.86
-- 202510 | CREDITO CONSUMO | 10160 | 10160 | 387100675.14
-- 202511 | CREDITO CONSUMO | 12958 | 12958 | 509228786.84
-- 202512 | CREDITO CONSUMO | 13344 | 13344 | 507548556.96


SELECT
  CODMES,
  DESTIPOPERACION,
  SUM(CASE WHEN FECDESEMBOLSO IS NOT NULL THEN 1 ELSE 0 END) AS cnt_con_fecha,
  SUM(CASE WHEN FLGDESEMBOLSADO = 1 THEN 1 ELSE 0 END) AS cnt_flg_desemb,
  SUM(MTODESEMBOLSADO) AS sum_mto_desemb
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_MIGRACION_PLANCHON
WHERE CODMES BETWEEN 202501 AND 202512
  AND DESTIPOPERACION IN ('TARJETA CREDITO NUEVA','TARJETA CREDITO STOCK')
GROUP BY CODMES, DESTIPOPERACION
ORDER BY CODMES, DESTIPOPERACION;

-- 202501 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202501 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202502 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202502 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202503 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202503 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202504 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202504 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202505 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202505 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202506 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202506 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202507 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202507 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202508 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202508 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202509 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202509 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202510 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202510 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202511 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202511 | TARJETA CREDITO STOCK | 0 | 0 | 0.00
-- 202512 | TARJETA CREDITO NUEVA | 0 | 0 | 0.00
-- 202512 | TARJETA CREDITO STOCK | 0 | 0 | 0.00




SELECT
  CODMES,
  DESTIPOPERACION,
  CODSOLICITUD,
  ESTADOSOLICITUD,
  FECDESEMBOLSO,
  FLGDESEMBOLSADO,
  MTODESEMBOLSADO
FROM CATALOG_LHCL_PROD_BCP_EXPL.BCP_EDV_RBMBDN.T72496_MIGRACION_PLANCHON
WHERE CODMES BETWEEN 202501 AND 202512
  AND DESTIPOPERACION IN ('TARJETA CREDITO NUEVA','TARJETA CREDITO STOCK')
  AND FECDESEMBOLSO IS NOT NULL
ORDER BY CODMES, DESTIPOPERACION, FECDESEMBOLSO
LIMIT 200;

-- SIN REGISTROS



AHORA PARA EL QUERY NUEVO CON LOS CAMBIOS QUE HEMOS HECHO
